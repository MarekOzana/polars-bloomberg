<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="Polars DataFrame interface for Bloomberg API" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Polars-Bloomberg</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Home";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> Polars-Bloomberg
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Home</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#core-methods">Core Methods</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bdp">BDP</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-fetching-the-last-price-currency-of-apple-and-seb">Example: Fetching the Last Price &amp; Currency of Apple and SEB</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bdh">BDH</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bql">BQL</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-basic-example-single-item-and-single-security">1. Basic Example: Single Item and Single Security</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-multiple-securities-with-a-single-item">2. Multiple Securities with a Single Item</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-multiple-items">3. Multiple Items</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#combining-results">Combining Results</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#4-advanced-example-screening-securities">4. Advanced Example: Screening Securities</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#average-pe-per-sector">Average PE per Sector</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#axes">Axes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#axes-with-all-columns">Axes with all columns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#segments">Segments</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#actual-and-forward-eps-estimates">Actual and Forward EPS Estimates</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#average-issuer-oas-spread-per-maturity-bucket">Average issuer OAS spread per maturity bucket</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#technical-analysis-stocks-with-20d-ema-200d-ema-and-rsi-53">Technical Analysis: stocks with 20d EMA &gt; 200d EMA and RSI &gt; 53</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#bond-universe-from-equity-ticker">Bond Universe from Equity Ticker</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#bonds-total-returns">Bonds Total Returns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#maturity-wall-for-us-hy-bonds">Maturity Wall for US HY Bonds</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#additional-documentation-resources">Additional Documentation &amp; Resources</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="api/">API Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="license/">License</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">Polars-Bloomberg</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Home</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/MarekOzana/polars-bloomberg/edit/master/docs/index.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p><img alt="Polars Bloomberg Logo" src="https://raw.githubusercontent.com/MarekOzana/polars-bloomberg/main/assets/polars-bloomberg-logo.jpg" /></p>
<h1 id="polars-bloomberg-open-api">Polars + Bloomberg Open API</h1>
<p><a href="https://github.com/MarekOzana/polars-bloomberg/actions/workflows/python-package.yml"><img alt="Tests" src="https://github.com/MarekOzana/polars-bloomberg/actions/workflows/python-package.yml/badge.svg" /></a>
<a href="LICENSE"><img alt="License" src="https://img.shields.io/badge/license-Apache%202.0-blue.svg" /></a></p>
<p><strong>polars-bloomberg</strong> is a Python library that extracts Bloombergâ€™s financial data directly into <a href="https://www.pola.rs/">Polars</a> DataFrames. <br />
If youâ€™re a quant financial analyst, data scientist, or quant developer working in capital markets, this library makes it easy to fetch, transform, and analyze Bloomberg data right in Polarsâ€”offering speed, efficient memory usage, and a lot of fun to use!</p>
<p><strong>Why use polars-bloomberg?</strong></p>
<ul>
<li><strong>User-Friendly Functions:</strong> Shortcuts like <code>bdp()</code>, <code>bdh()</code>, and <code>bql()</code> (inspired by Excel-like Bloomberg calls) let you pull data with minimal boilerplate.</li>
<li><strong>High-Performance Analytics:</strong> Polars is a lightning-fast DataFrame library. Combined with Bloombergâ€™s rich dataset, you get efficient data retrieval and minimal memory footprint</li>
<li><strong>No Pandas Dependency:</strong> Enjoy a clean integration that relies solely on Polars for speed and simplicity.</li>
</ul>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#core-methods">Core Methods</a><ul>
<li><a href="#bdp">BDP (Bloomberg Data Point)</a></li>
<li><a href="#bdh">BDH (Bloomberg Data History)</a></li>
<li><a href="#bql">BQL (Bloomberg Query Language)</a> <details><summary>BQL Examples</summary><ul>
<li><a href="#1-basic-example-single-item-and-single-security">Single Item and Single Security</a></li>
<li><a href="#2-multiple-securities-with-a-single-item">Multiple Securities with Single Item</a></li>
<li><a href="#3-multiple-items">Multiple Items</a></li>
<li><a href="#4-advanced-example-screening-securities">SRCH</a></li>
<li><a href="#average-pe-per-sector">Aggregation (AVG)</a></li>
<li><a href="#axes">Axes</a></li>
<li><a href="#axes-with-all-columns">Axes with All Columns</a></li>
<li><a href="#segments">Segments</a></li>
<li><a href="#average-issuer-oas-spread-per-maturity-bucket">Average Spread per Bucket</a></li>
<li><a href="#technical-analysis-stocks-with-20d-ema--200d-ema-and-rsi--53">Technical Analysis Screening</a></li>
<li><a href="#bond-universe-from-equity-ticker">Bonds Universe from Equity</a></li>
<li><a href="#bonds-total-returns">Bonds Total Return</a></li>
<li><a href="#maturity-wall-for-us-hy-bonds">Maturity Wall for US HY</a>
</details></li>
</ul>
</li>
</ul>
</li>
<li><a href="#additional-documentation--resources">Additional Documentation and Resources</a></li>
</ol>
<h2 id="introduction">Introduction</h2>
<p>Working with Bloomberg data in Python often feels more complicated than using their well-known Excel interface.
Great projects like <a href="https://github.com/matthewgilbert/blp">blp</a>, <a href="https://github.com/alpha-xone/xbbg">xbbg</a>, and <a href="https://github.com/matthewgilbert/pdblp">pdblp</a> have made this easier by pulling data directly into pandas. </p>
<p>With polars-bloomberg, you can enjoy the speed and simplicity of <a href="https://www.pola.rs/">Polars</a> DataFramesâ€”accessing both familiar Excel-style calls (<code>bdp</code>, <code>bdh</code>) and advanced <code>bql</code> queriesâ€”without extra pandas conversions. </p>
<p>I hope you enjoy using it as much as I had fun building it!</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><strong>Bloomberg Access:</strong> A valid Bloomberg terminal license.</li>
<li><strong>Bloomberg Python API:</strong> The <code>blpapi</code> library must be installed. See the <a href="https://www.bloomberg.com/professional/support/api-library/">Bloomberg API Library</a> for guidance.</li>
<li><strong>Python Version:</strong> Python 3.8+ recommended.</li>
</ul>
<h2 id="installation">Installation</h2>
<pre><code class="language-bash">pip install polars-bloomberg
</code></pre>
<h2 id="quick-start">Quick Start</h2>
<p>"Hello World" Example (under 1 minute):</p>
<pre><code class="language-python">from polars_bloomberg import BQuery

# Fetch the latest price for Apple (AAPL US Equity)
with BQuery() as bq:
    df = bq.bdp([&quot;AAPL US Equity&quot;], [&quot;PX_LAST&quot;])
    print(df)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security       â”† PX_LAST â”‚
â”‚ ---            â”† ---     â”‚
â”‚ str            â”† f64     â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡
â”‚ AAPL US Equity â”† 248.13  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>What this does:
- Establishes a Bloomberg connection using the context manager.
- Retrieves the last price of Apple shares.
- Returns the result as a Polars DataFrame.</p>
<p>If you see a price in <code>df</code>, your setup is working ğŸ¤©!!!</p>
<h2 id="core-methods">Core Methods</h2>
<p><code>BQuery</code> is your main interface. Using a context manager ensures the connection opens and closes cleanly. Within this session, you can use:
- <code>bq.bdp()</code> for Bloomberg Data Points (single-value fields).
- <code>bq.bdh()</code> for Historical Data (time series).
- <code>bq.bql()</code> for complex Bloomberg Query Language requests.</p>
<h2 id="bdp">BDP</h2>
<p>Use Case: Fetch the latest single-value data points (like last price, currency, or descriptive fields).</p>
<h3 id="example-fetching-the-last-price-currency-of-apple-and-seb">Example: Fetching the Last Price &amp; Currency of Apple and SEB</h3>
<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdp([&quot;AAPL US Equity&quot;, &quot;SEBA SS Equity&quot;], [&quot;PX_LAST&quot;, &quot;CRNCY&quot;])
    print(df)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security       â”† PX_LAST â”† CRNCY â”‚
â”‚ ---            â”† ---     â”† ---   â”‚
â”‚ str            â”† f64     â”† str   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ AAPL US Equity â”† 248.13  â”† USD   â”‚
â”‚ SEBA SS Equity â”† 155.2   â”† SEK   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<details><summary>Expand for more BDP Examples</summary>

### BDP with different column types

`polars-bloomberg` correctly infers column type as shown in this example:


<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdp([&quot;XS2930103580 Corp&quot;, &quot;USX60003AC87 Corp&quot;],
                [&quot;SECURITY_DES&quot;, &quot;YAS_ZSPREAD&quot;, &quot;CRNCY&quot;, &quot;NXT_CALL_DT&quot;])

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security          â”† SECURITY_DES   â”† YAS_ZSPREAD â”† CRNCY â”† NXT_CALL_DT â”‚
â”‚ ---               â”† ---            â”† ---         â”† ---   â”† ---         â”‚
â”‚ str               â”† str            â”† f64         â”† str   â”† date        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ XS2930103580 Corp â”† SEB 6 3/4 PERP â”† 304.676112  â”† USD   â”† 2031-11-04  â”‚
â”‚ USX60003AC87 Corp â”† NDAFH 6.3 PERP â”† 292.477506  â”† USD   â”† 2031-09-25  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>


### BDP with overrides
User can submit list of tuples with overrides

<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdp(
        [&quot;IBM US Equity&quot;],
        [&quot;PX_LAST&quot;, &quot;CRNCY_ADJ_PX_LAST&quot;],
        overrides=[(&quot;EQY_FUND_CRNCY&quot;, &quot;SEK&quot;)],
    )

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security      â”† PX_LAST â”† CRNCY_ADJ_PX_LAST â”‚
â”‚ ---           â”† ---     â”† ---               â”‚
â”‚ str           â”† f64     â”† f64               â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† 230.82  â”† 2535.174          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>


### BDP with date overrides
Overrides for dates has to be in format YYYYMMDD

<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdp([&quot;USX60003AC87 Corp&quot;], [&quot;SETTLE_DT&quot;],
                overrides=[(&quot;USER_LOCAL_TRADE_DATE&quot;, &quot;20241014&quot;)])

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security          â”† SETTLE_DT  â”‚
â”‚ ---               â”† ---        â”‚
â”‚ str               â”† date       â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ USX60003AC87 Corp â”† 2024-10-15 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>



<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdp(['USDSEK Curncy', 'SEKCZK Curncy'], 
                ['SETTLE_DT', 'PX_LAST'], 
                overrides=[('REFERENCE_DATE', '20200715')]
               )

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security      â”† SETTLE_DT  â”† PX_LAST â”‚
â”‚ ---           â”† ---        â”† ---     â”‚
â”‚ str           â”† date       â”† f64     â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡
â”‚ USDSEK Curncy â”† 2020-07-17 â”† 10.9778 â”‚
â”‚ SEKCZK Curncy â”† 2020-07-17 â”† 2.1698  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>


</details>

<h2 id="bdh">BDH</h2>
<p>Use Case: Retrieve historical data over a date range, such as daily closing prices or volumes.</p>
<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdh(
        [&quot;TLT US Equity&quot;],
        [&quot;PX_LAST&quot;],
        start_date=date(2019, 1, 1),
        end_date=date(2019, 1, 7),
    )
    print(df)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security      â”† date       â”† PX_LAST â”‚
â”‚ ---           â”† ---        â”† ---     â”‚
â”‚ str           â”† date       â”† f64     â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡
â”‚ TLT US Equity â”† 2019-01-02 â”† 122.15  â”‚
â”‚ TLT US Equity â”† 2019-01-03 â”† 123.54  â”‚
â”‚ TLT US Equity â”† 2019-01-04 â”† 122.11  â”‚
â”‚ TLT US Equity â”† 2019-01-07 â”† 121.75  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<details><summary>Expand for more BDH examples</summary>

### BDH with multiple securities / fields

<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdh(
        securities=[&quot;SPY US Equity&quot;, &quot;TLT US Equity&quot;],
        fields=[&quot;PX_LAST&quot;, &quot;VOLUME&quot;],
        start_date=date(2019, 1, 1),
        end_date=date(2019, 1, 10),
        options={&quot;adjustmentSplit&quot;: True},
    )
    print(df)

shape: (14, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security      â”† date       â”† PX_LAST â”† VOLUME       â”‚
â”‚ ---           â”† ---        â”† ---     â”† ---          â”‚
â”‚ str           â”† date       â”† f64     â”† f64          â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ SPY US Equity â”† 2019-01-02 â”† 250.18  â”† 1.26925199e8 â”‚
â”‚ SPY US Equity â”† 2019-01-03 â”† 244.21  â”† 1.44140692e8 â”‚
â”‚ SPY US Equity â”† 2019-01-04 â”† 252.39  â”† 1.42628834e8 â”‚
â”‚ SPY US Equity â”† 2019-01-07 â”† 254.38  â”† 1.031391e8   â”‚
â”‚ SPY US Equity â”† 2019-01-08 â”† 256.77  â”† 1.02512587e8 â”‚
â”‚ â€¦             â”† â€¦          â”† â€¦       â”† â€¦            â”‚
â”‚ TLT US Equity â”† 2019-01-04 â”† 122.11  â”† 1.2970226e7  â”‚
â”‚ TLT US Equity â”† 2019-01-07 â”† 121.75  â”† 8.498104e6   â”‚
â”‚ TLT US Equity â”† 2019-01-08 â”† 121.43  â”† 7.737103e6   â”‚
â”‚ TLT US Equity â”† 2019-01-09 â”† 121.24  â”† 9.349245e6   â”‚
â”‚ TLT US Equity â”† 2019-01-10 â”† 120.46  â”† 8.22286e6    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>


### BDH with options - periodicitySelection: Monthly

<pre><code class="language-python">with BQuery() as bq:
    df = bq.bdh(['AAPL US Equity'], 
                ['PX_LAST'], 
                start_date=date(2019, 1, 1), 
                end_date=date(2019, 3, 29),
                options={&quot;periodicitySelection&quot;: &quot;MONTHLY&quot;})

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ security       â”† date       â”† PX_LAST â”‚
â”‚ ---            â”† ---        â”† ---     â”‚
â”‚ str            â”† date       â”† f64     â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡
â”‚ AAPL US Equity â”† 2019-01-31 â”† 41.61   â”‚
â”‚ AAPL US Equity â”† 2019-02-28 â”† 43.288  â”‚
â”‚ AAPL US Equity â”† 2019-03-29 â”† 47.488  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

</details>

<h2 id="bql">BQL</h2>
<p><em>Use Case</em>: Run more advanced queries to screen securities, calculate analytics (like moving averages), or pull fundamental data with complex conditions.</p>
<p><em>Returns</em>: The <code>bql()</code> method returns a <code>BqlResult</code> object, which:
- Acts like a list of Polars DataFrames (one for each item in BQL <code>get</code> statement).
- Provides a <code>.combine()</code> method to merge DataFrames on common columns.</p>
<h3 id="1-basic-example-single-item-and-single-security">1. Basic Example: Single Item and Single Security</h3>
<pre><code class="language-python"># Fetch the last price of IBM stock
with BQuery() as bq:
    results = bq.bql(&quot;get(px_last) for(['IBM US Equity'])&quot;)
    print(results[0])  # Access the first DataFrame
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† px_last â”† DATE       â”† CURRENCY â”‚
â”‚ ---           â”† ---     â”† ---        â”† ---      â”‚
â”‚ str           â”† f64     â”† date       â”† str      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† 230.82  â”† 2024-12-14 â”† USD      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="2-multiple-securities-with-a-single-item">2. Multiple Securities with a Single Item</h3>
<pre><code class="language-python"># Fetch the last price for IBM and SEB
with BQuery() as bq:
    results = bq.bql(&quot;get(px_last) for(['IBM US Equity', 'SEBA SS Equity'])&quot;)
    print(results[0])
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID             â”† px_last â”† DATE       â”† CURRENCY â”‚
â”‚ ---            â”† ---     â”† ---        â”† ---      â”‚
â”‚ str            â”† f64     â”† date       â”† str      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity  â”† 230.82  â”† 2024-12-14 â”† USD      â”‚
â”‚ SEBA SS Equity â”† 155.2   â”† 2024-12-14 â”† SEK      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="3-multiple-items">3. Multiple Items</h3>
<p>When querying for multiple items, <code>bql()</code> returns a list of DataFrames</p>
<pre><code class="language-python"># Fetch name and last price of IBM (two items)
with BQuery() as bq:
    results = bq.bql(&quot;get(name, px_last) for(['IBM US Equity'])&quot;)
</code></pre>
<p>Output:</p>
<pre><code class="language-python">&gt;&gt;&gt; print(len(results))  # 2 DataFrames
n=2

&gt;&gt;&gt; print(results[0])    # First DataFrame: 'name'
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† name                           â”‚
â”‚ ---           â”† ---                            â”‚
â”‚ str           â”† str                            â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† International Business Machine â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

&gt;&gt;&gt; print(results[1])    # Second DataFrame: 'px_last'
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† px_last â”† DATE       â”† CURRENCY â”‚
â”‚ ---           â”† ---     â”† ---        â”† ---      â”‚
â”‚ str           â”† f64     â”† date       â”† str      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† 230.82  â”† 2024-12-14 â”† USD      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="combining-results">Combining Results</h4>
<pre><code class="language-python">&gt;&gt;&gt; combined_df = results.combine()
&gt;&gt;&gt; print(combined_df)
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† name                           â”† px_last â”† DATE       â”† CURRENCY â”‚
â”‚ ---           â”† ---                            â”† ---     â”† ---        â”† ---      â”‚
â”‚ str           â”† str                            â”† f64     â”† date       â”† str      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† International Business Machine â”† 230.82  â”† 2024-12-14 â”† USD      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="4-advanced-example-screening-securities">4. Advanced Example: Screening Securities</h3>
<p>Find list of SEB and Handelsbanken's AT1 bonds and print their names, duration and Z-Spread.</p>
<pre><code class="language-python">query=&quot;&quot;&quot;
    let(#dur=duration(duration_type=MODIFIED); 
        #zsprd=spread(spread_type=Z);) 
    get(name(), #dur, #zsprd) 
    for(filter(screenresults(type=SRCH, screen_name='@COCO'), 
            ticker in ['SEB', 'SHBASS']))
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    combined_df = results.combine()
    print(combined_df)
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† name()          â”† #dur â”† DATE       â”† #zsprd â”‚
â”‚ ---           â”† ---             â”† ---  â”† ---        â”† ---    â”‚
â”‚ str           â”† str             â”† f64  â”† date       â”† f64    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ BW924993 Corp â”† SEB 6 â… PERP    â”† 2.23 â”† 2024-12-16 â”† 212.0  â”‚
â”‚ YV402592 Corp â”† SEB Float PERP  â”† 0.21 â”† 2024-12-16 â”† 233.0  â”‚
â”‚ ZQ349286 Corp â”† SEB 5 â…› PERP    â”† 0.39 â”† 2024-12-16 â”† 186.0  â”‚
â”‚ ZO703315 Corp â”† SHBASS 4 â…œ PERP â”† 1.95 â”† 2024-12-16 â”† 213.0  â”‚
â”‚ ZO703956 Corp â”† SHBASS 4 Â¾ PERP â”† 4.94 â”† 2024-12-16 â”† 256.0  â”‚
â”‚ YU819930 Corp â”† SEB 6 Â¾ PERP    â”† 5.37 â”† 2024-12-16 â”† 309.0  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="average-pe-per-sector">Average PE per Sector</h3>
<p>This example shows aggregation (average) per group (sector) for members of an index.
The resulting list has only one element since there is only one data-item in <code>get</code></p>
<pre><code class="language-python">query = &quot;&quot;&quot;
    let(#avg_pe=avg(group(pe_ratio(), gics_sector_name()));)
    get(#avg_pe)
    for(members('OMX Index'))
&quot;&quot;&quot;
with BQuery() as bq:
    results = bq.bql(query)
    print(results[0].head(5))
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID           â”† #avg_pe   â”† REVISION_DAT â”† AS_OF_DATE â”† PERIOD_END_D â”† ORIG_IDS     â”† GICS_SECTOR â”‚
â”‚ ---          â”† ---       â”† E            â”† ---        â”† ATE          â”† ---          â”† _NAME()     â”‚
â”‚ str          â”† f64       â”† ---          â”† date       â”† ---          â”† str          â”† ---         â”‚
â”‚              â”†           â”† date         â”†            â”† date         â”†              â”† str         â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ Communicatio â”† 19.561754 â”† 2024-10-24   â”† 2024-12-14 â”† 2024-09-30   â”† null         â”† Communicati â”‚
â”‚ n Services   â”†           â”†              â”†            â”†              â”†              â”† on Services â”‚
â”‚ Consumer Dis â”† 19.117295 â”† 2024-10-24   â”† 2024-12-14 â”† 2024-09-30   â”† null         â”† Consumer    â”‚
â”‚ cretionary   â”†           â”†              â”†            â”†              â”†              â”† Discretiona â”‚
â”‚              â”†           â”†              â”†            â”†              â”†              â”† ry          â”‚
â”‚ Consumer     â”† 15.984743 â”† 2024-10-24   â”† 2024-12-14 â”† 2024-09-30   â”† ESSITYB SS   â”† Consumer    â”‚
â”‚ Staples      â”†           â”†              â”†            â”†              â”† Equity       â”† Staples     â”‚
â”‚ Financials   â”† 6.815895  â”† 2024-10-24   â”† 2024-12-14 â”† 2024-09-30   â”† null         â”† Financials  â”‚
â”‚ Health Care  â”† 22.00628  â”† 2024-11-12   â”† 2024-12-14 â”† 2024-09-30   â”† null         â”† Health Care â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="axes">Axes</h3>
<p>Get current axes of all Swedish USD AT1 bonds</p>
<pre><code class="language-python"># Get current axes for Swedish AT1 bonds in USD
query=&quot;&quot;&quot;
    let(#ax=axes();)
    get(security_des, #ax)
    for(filter(bondsuniv(ACTIVE),
        crncy()=='USD' and
        basel_iii_designation() == 'Additional Tier 1' and
        country_iso() == 'SE'))
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    print(results.combine())

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† security_des    â”† #ax â”† ASK_DEPTH â”† BID_DEPTH â”† ASK_TOTAL_SIZE â”† BID_TOTAL_SIZE â”‚
â”‚ ---           â”† ---             â”† --- â”† ---       â”† ---       â”† ---            â”† ---            â”‚
â”‚ str           â”† str             â”† str â”† i64       â”† i64       â”† f64            â”† f64            â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ YU819930 Corp â”† SEB 6 Â¾ PERP    â”† Y   â”† 2         â”† null      â”† 5.6e6          â”† null           â”‚
â”‚ ZO703315 Corp â”† SHBASS 4 â…œ PERP â”† Y   â”† 1         â”† 2         â”† 5e6            â”† 6e6            â”‚
â”‚ BR069680 Corp â”† SWEDA 4 PERP    â”† Y   â”† null      â”† 1         â”† null           â”† 3e6            â”‚
â”‚ ZL122341 Corp â”† SWEDA 7 â… PERP  â”† Y   â”† null      â”† 6         â”† null           â”† 2.04e7         â”‚
â”‚ ZQ349286 Corp â”† SEB 5 â…› PERP    â”† Y   â”† 2         â”† 4         â”† 5.5e6          â”† 3e7            â”‚
â”‚ ZF859199 Corp â”† SWEDA 7 Â¾ PERP  â”† Y   â”† 1         â”† 1         â”† 2e6            â”† 2e6            â”‚
â”‚ ZO703956 Corp â”† SHBASS 4 Â¾ PERP â”† Y   â”† 1         â”† 3         â”† 1.2e6          â”† 1.1e7          â”‚
â”‚ BW924993 Corp â”† SEB 6 â… PERP    â”† Y   â”† 1         â”† 3         â”† 5e6            â”† 1.1e7          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="axes-with-all-columns">Axes with all columns</h3>
<pre><code class="language-python"># RT1 Axes with all columns
query = &quot;&quot;&quot;
let(#ax=axes();)
get(name, #ax, amt_outstanding)
for(filter(bondsuniv(ACTIVE),
    crncy() in ['USD', 'EUR'] and
    solvency_ii_designation() == 'Restricted Tier 1' and
    amt_outstanding() &gt; 7.5e8 and
    is_axed('Bid') == True))
preferences(addcols=all)
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    print(results.combine())
</code></pre>
<p>Output:</p>
<div>
<small>shape: (3, 33)</small><table border="1" class="dataframe"><thead><tr><th>ID</th><th>name</th><th>#ax</th><th>ASK_PRICE</th><th>BID_PRICE</th><th>ASK_DEPTH</th><th>BID_DEPTH</th><th>ASK_DEALER</th><th>BID_DEALER</th><th>ASK_SIZE</th><th>BID_SIZE</th><th>ASK_TOTAL_SIZE</th><th>BID_TOTAL_SIZE</th><th>ASK_PRICE_IS_DERIVED</th><th>BID_PRICE_IS_DERIVED</th><th>ASK_SPREAD</th><th>BID_SPREAD</th><th>ASK_SPREAD_IS_DERIVED</th><th>BID_SPREAD_IS_DERIVED</th><th>ASK_YIELD</th><th>BID_YIELD</th><th>ASK_YIELD_IS_DERIVED</th><th>BID_YIELD_IS_DERIVED</th><th>ASK_AXE_SOURCE</th><th>BID_AXE_SOURCE</th><th>ASK_BROKER</th><th>BID_BROKER</th><th>ASK_HIST_AGG_SIZE</th><th>BID_HIST_AGG_SIZE</th><th>amt_outstanding</th><th>CURRENCY_OF_ISSUE</th><th>MULTIPLIER</th><th>CURRENCY</th></tr><tr><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i64</td><td>i64</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>bool</td><td>bool</td><td>f64</td><td>f64</td><td>bool</td><td>bool</td><td>f64</td><td>f64</td><td>bool</td><td>bool</td><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>f64</td><td>str</td></tr></thead><tbody><tr><td>&quot;BM368057 Corp&quot;</td><td>&quot;ALVGR 2 â… PERP&quot;</td><td>&quot;Y&quot;</td><td>88.034</td><td>87.427</td><td>5</td><td>1</td><td>&quot;BARC&quot;</td><td>&quot;IMI&quot;</td><td>1.2e6</td><td>1e6</td><td>7.2e6</td><td>1e6</td><td>null</td><td>null</td><td>287.031</td><td>300.046</td><td>true</td><td>true</td><td>4.854</td><td>4.976</td><td>true</td><td>true</td><td>&quot;ERUN&quot;</td><td>&quot;ERUN&quot;</td><td>&quot;BXOL&quot;</td><td>&quot;IMIC&quot;</td><td>6.68e6</td><td>8.92e6</td><td>1.2500e9</td><td>&quot;EUR&quot;</td><td>1.0</td><td>&quot;EUR&quot;</td></tr><tr><td>&quot;EK588238 Corp&quot;</td><td>&quot;ASSGEN 4.596 PERP&quot;</td><td>&quot;Y&quot;</td><td>101.0</td><td>100.13</td><td>4</td><td>6</td><td>&quot;MSAX&quot;</td><td>&quot;A2A&quot;</td><td>500000.0</td><td>100000.0</td><td>1.556e7</td><td>3.83e7</td><td>null</td><td>null</td><td>108.9</td><td>207.889</td><td>true</td><td>true</td><td>3.466</td><td>4.434</td><td>null</td><td>true</td><td>&quot;ERUN&quot;</td><td>&quot;BBX&quot;</td><td>&quot;MSAX&quot;</td><td>&quot;A2A&quot;</td><td>1.70424e7</td><td>3.17e7</td><td>1.0004e9</td><td>&quot;EUR&quot;</td><td>1.0</td><td>&quot;EUR&quot;</td></tr><tr><td>&quot;BR244025 Corp&quot;</td><td>&quot;ALVGR 3.2 PERP&quot;</td><td>&quot;Y&quot;</td><td>88.0</td><td>86.875</td><td>3</td><td>4</td><td>&quot;UBS&quot;</td><td>&quot;DB&quot;</td><td>5e6</td><td>1e6</td><td>1.1e7</td><td>1.4e7</td><td>null</td><td>null</td><td>49.33</td><td>414.602</td><td>true</td><td>true</td><td>7.34258</td><td>8.553</td><td>null</td><td>true</td><td>&quot;ERUN&quot;</td><td>&quot;ERUN&quot;</td><td>&quot;UBSW&quot;</td><td>&quot;DABC&quot;</td><td>1.6876e6</td><td>3.6e7</td><td>1.2500e9</td><td>&quot;USD&quot;</td><td>1.0</td><td>&quot;USD&quot;</td></tr></tbody></table></div>

<h3 id="segments">Segments</h3>
<p>The following example shows handling of two data-items with different length. The first dataframe 
describes the segments (and has length 5 in this case), while the second dataframe contains time series.
One can join the dataframes on common columns and pivot the segments into columns as shown below:</p>
<pre><code class="language-python"># revenue per segment
query = &quot;&quot;&quot;
    let(#segment=segment_name();
        #revenue=sales_Rev_turn(fpt=q, fpr=range(2023Q3, 2024Q3));
        )
    get(#segment, #revenue)
    for(segments('GTN US Equity',type=reported,hierarchy=PRODUCT, level=1))
&quot;&quot;&quot;
with BQuery() as bq:
    results = bq.bql(query)
    df = results.combine().pivot(
        index=&quot;PERIOD_END_DATE&quot;, on=&quot;#segment&quot;, values=&quot;#revenue&quot;
    )
    print(df)
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PERIOD_END_DATE â”† Broadcasting â”† Production Companies â”† Other  â”† Adjustment â”‚
â”‚ ---             â”† ---          â”† ---                  â”† ---    â”† ---        â”‚
â”‚ date            â”† f64          â”† f64                  â”† f64    â”† f64        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 2023-09-30      â”† 7.83e8       â”† 2e7                  â”† 1.6e7  â”† null       â”‚
â”‚ 2023-12-31      â”† 8.13e8       â”† 3.2e7                â”† 1.9e7  â”† null       â”‚
â”‚ 2024-03-31      â”† 7.8e8        â”† 2.4e7                â”† 1.9e7  â”† null       â”‚
â”‚ 2024-06-30      â”† 8.08e8       â”† 1.8e7                â”† 0.0    â”† null       â”‚
â”‚ 2024-09-30      â”† 9.24e8       â”† 2.6e7                â”† 1.7e7  â”† null       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="actual-and-forward-eps-estimates">Actual and Forward EPS Estimates</h3>
<pre><code class="language-python">with BQuery() as bq:
    results = bq.bql(&quot;&quot;&quot;
        let(#eps=is_eps(fa_period_type='A',
                        fa_period_offset=range(-4,2));)
        get(#eps)
        for(['IBM US Equity'])
    &quot;&quot;&quot;)
    print(results[0])

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† #eps  â”† REVISION_DATE â”† AS_OF_DATE â”† PERIOD_END_DATE â”† CURRENCY â”‚
â”‚ ---           â”† ---   â”† ---           â”† ---        â”† ---             â”† ---      â”‚
â”‚ str           â”† f64   â”† date          â”† date       â”† date            â”† str      â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡
â”‚ IBM US Equity â”† 10.63 â”† 2022-02-22    â”† 2024-12-14 â”† 2019-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 6.28  â”† 2023-02-28    â”† 2024-12-14 â”† 2020-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 6.41  â”† 2023-02-28    â”† 2024-12-14 â”† 2021-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 1.82  â”† 2024-03-18    â”† 2024-12-14 â”† 2022-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 8.23  â”† 2024-03-18    â”† 2024-12-14 â”† 2023-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 7.891 â”† 2024-12-13    â”† 2024-12-14 â”† 2024-12-31      â”† USD      â”‚
â”‚ IBM US Equity â”† 9.236 â”† 2024-12-13    â”† 2024-12-14 â”† 2025-12-31      â”† USD      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="average-issuer-oas-spread-per-maturity-bucket">Average issuer OAS spread per maturity bucket</h3>
<pre><code class="language-python"># Example: Average OAS-spread per maturity bucket
query = &quot;&quot;&quot;
let(
    #bins = bins(maturity_years,
                 [3,9,18,30],
                 ['(1) 0-3','(2) 3-9','(3) 9-18','(4) 18-30','(5) 30+']);
    #average_spread = avg(group(spread(st=oas),#bins));
)
get(#average_spread)
for(filter(bonds('NVDA US Equity', issuedby = 'ENTITY'),
           maturity_years != NA))
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    print(results[0])
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID        â”† #average_spread â”† DATE       â”† ORIG_IDS      â”† #BINS     â”‚
â”‚ ---       â”† ---             â”† ---        â”† ---           â”† ---       â”‚
â”‚ str       â”† f64             â”† date       â”† str           â”† str       â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ (1) 0-3   â”† 31.195689       â”† 2024-12-14 â”† QZ552396 Corp â”† (1) 0-3   â”‚
â”‚ (2) 3-9   â”† 59.580383       â”† 2024-12-14 â”† null          â”† (2) 3-9   â”‚
â”‚ (3) 9-18  â”† 110.614416      â”† 2024-12-14 â”† BH393780 Corp â”† (3) 9-18  â”‚
â”‚ (4) 18-30 â”† 135.160279      â”† 2024-12-14 â”† BH393781 Corp â”† (4) 18-30 â”‚
â”‚ (5) 30+   â”† 150.713405      â”† 2024-12-14 â”† BH393782 Corp â”† (5) 30+   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="technical-analysis-stocks-with-20d-ema-200d-ema-and-rsi-53">Technical Analysis: stocks with 20d EMA &gt; 200d EMA and RSI &gt; 53</h3>
<pre><code class="language-python">with BQuery() as bq:
    results = bq.bql(
        &quot;&quot;&quot;
        let(#ema20=emavg(period=20);
            #ema200=emavg(period=200);
            #rsi=rsi(close=px_last());)
        get(name(), #ema20, #ema200, #rsi)
        for(filter(members('OMX Index'),
                    and(#ema20 &gt; #ema200, #rsi &gt; 53)))
        with(fill=PREV)
        &quot;&quot;&quot;
    )
    print(results.combine())
</code></pre>
<p>Output:</p>
<pre><code class="language-python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID              â”† name()           â”† #ema20     â”† DATE       â”† CURRENCY â”† #ema200    â”† #rsi      â”‚
â”‚ ---             â”† ---              â”† ---        â”† ---        â”† ---      â”† ---        â”† ---       â”‚
â”‚ str             â”† str              â”† f64        â”† date       â”† str      â”† f64        â”† f64       â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ ERICB SS Equity â”† Telefonaktiebola â”† 90.152604  â”† 2024-12-16 â”† SEK      â”† 75.072151  â”† 56.010028 â”‚
â”‚                 â”† get LM Ericsso   â”†            â”†            â”†          â”†            â”†           â”‚
â”‚ ABB SS Equity   â”† ABB Ltd          â”† 630.622469 â”† 2024-12-16 â”† SEK      â”† 566.571183 â”† 53.763102 â”‚
â”‚ SEBA SS Equity  â”† Skandinaviska    â”† 153.80595  â”† 2024-12-16 â”† SEK      â”† 150.742394 â”† 56.460733 â”‚
â”‚                 â”† Enskilda Banken  â”†            â”†            â”†          â”†            â”†           â”‚
â”‚ ASSAB SS Equity â”† Assa Abloy AB    â”† 339.017591 â”† 2024-12-16 â”† SEK      â”† 317.057573 â”† 53.351619 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="bond-universe-from-equity-ticker">Bond Universe from Equity Ticker</h3>
<pre><code class="language-python"># Get Bond Universe from Equity Ticker
query = &quot;&quot;&quot;
let(#rank=normalized_payment_rank();
    #oas=spread(st=oas);
    #nxt_call=nxt_call_dt();
    )
get(name(), #rank, #nxt_call, #oas)
for(filter(bonds('GTN US Equity'), series() == '144A'))
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    df = results.combine()
    print(df)
</code></pre>
<p>Output:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID            â”† name()            â”† #rank            â”† #nxt_call  â”† #oas       â”† DATE       â”‚
â”‚ ---           â”† ---               â”† ---              â”† ---        â”† ---        â”† ---        â”‚
â”‚ str           â”† str               â”† str              â”† date       â”† f64        â”† date       â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ YX231113 Corp â”† GTN 10 Â½ 07/15/29 â”† 1st Lien Secured â”† 2026-07-15 â”† 598.66491  â”† 2024-12-17 â”‚
â”‚ BS116983 Corp â”† GTN 5 â…œ 11/15/31  â”† Sr Unsecured     â”† 2026-11-15 â”† 1193.17529 â”† 2024-12-17 â”‚
â”‚ AV438089 Corp â”† GTN 7 05/15/27    â”† Sr Unsecured     â”† 2024-12-24 â”† 400.340456 â”† 2024-12-17 â”‚
â”‚ ZO860846 Corp â”† GTN 4 Â¾ 10/15/30  â”† Sr Unsecured     â”† 2025-10-15 â”† 1249.34346 â”† 2024-12-17 â”‚
â”‚ LW375188 Corp â”† GTN 5 â… 07/15/26  â”† Sr Unsecured     â”† 2025-01-13 â”† 173.761744 â”† 2024-12-17 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="bonds-total-returns">Bonds Total Returns</h3>
<p>This is example of a single-item query returning total return for all GTN bonds in a long dataframe.
We can easily pivot it into wide format, as in the example below</p>
<pre><code class="language-python"># Total Return of GTN Bonds
query = &quot;&quot;&quot;
let(#rng = range(-1M, 0D);
    #rets = return_series(calc_interval=#rng,per=W);)
get(#rets)
for(filter(bonds('GTN US Equity'), series() == '144A'))
&quot;&quot;&quot;

with BQuery() as bq:
    results = bq.bql(query)
    df = results[0].pivot(on=&quot;ID&quot;, index=&quot;DATE&quot;, values=&quot;#rets&quot;)
    print(df)
</code></pre>
<p>Output:</p>
<pre><code class="language-python">shape: (6, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATE       â”† YX231113 Corp â”† BS116983 Corp â”† AV438089 Corp â”† ZO860846 Corp â”† LW375188 Corp â”‚
â”‚ ---        â”† ---           â”† ---           â”† ---           â”† ---           â”† ---           â”‚
â”‚ date       â”† f64           â”† f64           â”† f64           â”† f64           â”† f64           â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 2024-11-17 â”† null          â”† null          â”† null          â”† null          â”† null          â”‚
â”‚ 2024-11-24 â”† 0.001653      â”† 0.051179      â”† 0.020363      â”† 0.001371      â”† -0.002939     â”‚
â”‚ 2024-12-01 â”† 0.002837      â”† 0.010405      â”† -0.001466     â”† 0.007275      â”† 0.000581      â”‚
â”‚ 2024-12-08 â”† -0.000041     â”† 0.016145      â”† 0.000766      â”† 0.024984      â”† 0.000936      â”‚
â”‚ 2024-12-15 â”† 0.001495      â”† -0.047        â”† -0.000233     â”† -0.043509     â”† 0.002241      â”‚
â”‚ 2024-12-17 â”† 0.00008       â”† -0.000004     â”† -0.0035       â”† -0.007937     â”† 0.000064      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="maturity-wall-for-us-hy-bonds">Maturity Wall for US HY Bonds</h3>
<pre><code class="language-python">query = &quot;&quot;&quot;
let(#mv=sum(group(amt_outstanding(currency=USD),
                  by=[year(maturity()), industry_sector()]));)
get(#mv)
for(members('LF98TRUU Index'))
&quot;&quot;&quot;
with BQuery() as bq:
    results = bq.bql(query)
df = results.combine().rename(
    {&quot;YEAR(MATURITY())&quot;: &quot;maturity&quot;, &quot;INDUSTRY_SECTOR()&quot;: &quot;sector&quot;, &quot;#mv&quot;: &quot;mv&quot;}
)

print(df.pivot(index=&quot;maturity&quot;, on=&quot;sector&quot;, values=&quot;mv&quot;).head())
</code></pre>
<p>Output:</p>
<pre><code class="language-python">shape: (5, 11)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ maturity â”† Basic     â”† Consumer, â”† Energy    â”† â€¦ â”† Financial â”† Technolog â”† Utilities â”† Diversifi â”‚
â”‚ ---      â”† Materials â”† Non-cycli â”† ---       â”†   â”† ---       â”† y         â”† ---       â”† ed        â”‚
â”‚ i64      â”† ---       â”† cal       â”† f64       â”†   â”† f64       â”† ---       â”† f64       â”† ---       â”‚
â”‚          â”† f64       â”† ---       â”†           â”†   â”†           â”† f64       â”†           â”† f64       â”‚
â”‚          â”†           â”† f64       â”†           â”†   â”†           â”†           â”†           â”†           â”‚
â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 2025     â”† 1.5e8     â”† 5.34916e8 â”† 5e8       â”† â€¦ â”† null      â”† null      â”† null      â”† null      â”‚
â”‚ 2026     â”† 4.4013e9  â”† 9.3293e9  â”† 8.2931e9  â”† â€¦ â”† 1.3524e10 â”† 4.0608e9  â”† 2.5202e9  â”† null      â”‚
â”‚ 2027     â”† 8.3921e9  â”† 2.3409e10 â”† 1.2427e10 â”† â€¦ â”† 1.9430e10 â”† 4.3367e9  â”† 3.6620e9  â”† null      â”‚
â”‚ 2028     â”† 1.4701e10 â”† 3.7457e10 â”† 2.2442e10 â”† â€¦ â”† 2.3341e10 â”† 9.9143e9  â”† 7.6388e9  â”† 5e8       â”‚
â”‚ 2029     â”† 1.6512e10 â”† 5.7381e10 â”† 3.9286e10 â”† â€¦ â”† 4.2337e10 â”† 2.2660e10 â”† 5.8558e9  â”† null      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 id="additional-documentation-resources">Additional Documentation &amp; Resources</h2>
<ul>
<li>
<p><em>API Documentation</em>: Detailed documentation and function references are available in the <a href="api/">API documentation</a> file within the <code>examples/</code> directory.</p>
</li>
<li>
<p><em>Additional Examples</em>: Check out <a href="examples/">examples/</a> for hands-on notebooks demonstrating a variety of use cases.</p>
<ul>
<li>BQL examples and use cases: <a href="https://github.com/MarekOzana/polars-bloomberg/blob/main/examples/Examples-BQL.ipynb">examples/Examples-BQL.ipynb</a></li>
</ul>
</li>
<li>
<p><em>Bloomberg Developer Resources</em>: For more details on the Bloomberg API itself, visit the <a href="https://developer.bloomberg.com/">Bloomberg Developer's page</a>.</p>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="api/" class="btn btn-neutral float-right" title="API Reference">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/MarekOzana/polars-bloomberg" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
      <span><a href="api/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2024-12-21 18:03:22.462181+00:00
-->
