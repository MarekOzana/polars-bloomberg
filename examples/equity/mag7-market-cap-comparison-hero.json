{"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "axis": {"labelAngle": 0, "titleFontSize": 12, "titlePadding": 10}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"color": {"condition": {"test": "(datum.basket === 'Magnificent 7')", "field": "ID", "legend": null, "scale": {"domain": ["TSLA US Equity", "META US Equity", "AMZN US Equity", "MSFT US Equity", "AAPL US Equity", "GOOGL US Equity", "NVDA US Equity"], "range": ["#1D3B5A", "#FF5B2F", "#4885C4", "#48B866", "#FBC111", "#005D34", "#2AA6A1"]}, "type": "nominal"}, "value": "#D3C4A6"}, "order": {"field": "mkt_cap", "sort": "ascending", "type": "quantitative"}, "tooltip": [{"field": "basket", "title": "Bar", "type": "nominal"}, {"field": "component", "title": "Component", "type": "nominal"}, {"aggregate": "sum", "field": "mkt_cap", "format": ",.0f", "title": "Market cap (USD bn)", "type": "quantitative"}], "x": {"field": "basket", "sort": ["Magnificent 7", "SXXP", "SHCOMP", "TPX", "UKX", "CAC", "DAX"], "title": null, "type": "nominal"}, "y": {"aggregate": "sum", "axis": {"format": ",.0f"}, "field": "mkt_cap", "title": "Market cap (USD bn)", "type": "quantitative"}}}, {"mark": {"type": "text", "baseline": "middle", "color": "black", "fontSize": 11}, "encoding": {"text": {"field": "short", "type": "nominal"}, "tooltip": [{"field": "component", "title": "Company", "type": "nominal"}, {"field": "seg_cap", "format": ",.0f", "title": "Market cap (USD bn)", "type": "quantitative"}], "x": {"field": "basket", "sort": ["Magnificent 7", "SXXP", "SHCOMP", "TPX", "UKX", "CAC", "DAX"], "title": null, "type": "nominal"}, "y": {"field": "y_mid", "title": "Market cap (USD bn)", "type": "quantitative"}}, "transform": [{"filter": "(datum.basket === 'Magnificent 7')"}, {"aggregate": [{"op": "sum", "field": "mkt_cap", "as": "seg_cap"}], "groupby": ["basket", "component"]}, {"window": [{"op": "sum", "field": "seg_cap", "as": "cum"}], "groupby": ["basket"], "sort": [{"field": "seg_cap", "order": "ascending"}]}, {"calculate": "datum.cum - datum.seg_cap/2", "as": "y_mid"}, {"calculate": "split(datum.component, ' ')[0]", "as": "short"}]}], "data": {"name": "data-d9aaf14fbf47a157d81a09e86cd8957e"}, "height": 400, "resolve": {"scale": {"x": "shared", "y": "shared"}}, "title": "Mag 7 Market Capitalization vs. Major Indexes", "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v6.1.0.json", "datasets": {"data-d9aaf14fbf47a157d81a09e86cd8957e": [{"ID": "AAPL US Equity", "#name": "Apple Inc", "#mkt_cap": 3808.3096210278627, "basket": "Magnificent 7", "component": "Apple Inc", "mkt_cap": 3808.3096210278627}, {"ID": "AMZN US Equity", "#name": "Amazon.com Inc", "#mkt_cap": 2620.118506265625, "basket": "Magnificent 7", "component": "Amazon.com Inc", "mkt_cap": 2620.118506265625}, {"ID": "GOOGL US Equity", "#name": "Alphabet Inc", "#mkt_cap": 3971.0640277404787, "basket": "Magnificent 7", "component": "Alphabet Inc", "mkt_cap": 3971.0640277404787}, {"ID": "META US Equity", "#name": "Meta Platforms Inc", "#mkt_cap": 1636.9674459941118, "basket": "Magnificent 7", "component": "Meta Platforms Inc", "mkt_cap": 1636.9674459941118}, {"ID": "MSFT US Equity", "#name": "Microsoft Corp", "#mkt_cap": 3528.0753671974026, "basket": "Magnificent 7", "component": "Microsoft Corp", "mkt_cap": 3528.0753671974026}, {"ID": "NVDA US Equity", "#name": "NVIDIA Corp", "#mkt_cap": 4482.059655761719, "basket": "Magnificent 7", "component": "NVIDIA Corp", "mkt_cap": 4482.059655761719}, {"ID": "TSLA US Equity", "#name": "Tesla Inc", "#mkt_cap": 1468.9188589768492, "basket": "Magnificent 7", "component": "Tesla Inc", "mkt_cap": 1468.9188589768492}, {"ID": "SXXP Index", "#name": "SXXP Index", "#mkt_cap": 18195.345914938665, "basket": "SXXP", "component": "Index total", "mkt_cap": 18195.345914938665}, {"ID": "DAX Index", "#name": "DAX Index", "#mkt_cap": 2447.9271106743704, "basket": "DAX", "component": "Index total", "mkt_cap": 2447.9271106743704}, {"ID": "UKX Index", "#name": "UKX Index", "#mkt_cap": 3485.662191049302, "basket": "UKX", "component": "Index total", "mkt_cap": 3485.662191049302}, {"ID": "CAC Index", "#name": "CAC Index", "#mkt_cap": 3049.2462126658825, "basket": "CAC", "component": "Index total", "mkt_cap": 3049.2462126658825}, {"ID": "TPX Index", "#name": "TPX Index", "#mkt_cap": 7580.425898978317, "basket": "TPX", "component": "Index total", "mkt_cap": 7580.425898978317}, {"ID": "SHCOMP Index", "#name": "SHCOMP Index", "#mkt_cap": 9270.19087669592, "basket": "SHCOMP", "component": "Index total", "mkt_cap": 9270.19087669592}]}}